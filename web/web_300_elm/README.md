# Охотник за камнями

### Сложность: 300
### Категория: web

### Описание:
Для постройки новой пирамиды, необходимо собрать определенное количество блоков. Но фараон разрешит строить первому собравшему, а охотников увековечить своё имя, как строителя пирамиды много. Торопитесь!
Формат флага: начинается с решетки (#)

### Решение:

Запустив игру(files_for_ctf_players/client.zip) видим, что нужно собрать тысячу камней.

Разбираем исходники игры (files_for_ctf_players/client-sources.zip).
Обращаем внимание на то, что при инициализации модели (Models.elm) отсутствуют переменные urlListen,salt.
Выясняем, что для отправки сообщения о поглощения камня используется подпись, в которой присутствует salt.
~~~~
Util.elm:18
sha = sha256 (message_ ++ (toString model.scene.player.score)  ++ (toString t_) ++ model.salt)
~~~~

Деобфусцируем клиентский js файл (client.zip/target/elm-obfuscate.js)

Если предположить, что в urlListen используется ip адрес сервера, а salt идет через одну переменную, с легкостью находим salt.
~~~~
sdl4Df4(dsk!3sk*3saKha13SHA@fsl#
~~~~
Дальше подставляем в исходники игры найденную соль в переменную salt, ip сервера в переменные urlListen и urlSend, 
выставляем score в 1000 очков в инициализации игрока (Model/Scene.elm), компилируем Elm, запускаем игру 
и при поглощении следующего камня будет выведен флаг.

На сервере проверки количества поглощенных камней не было.